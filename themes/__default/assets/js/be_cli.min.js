"use strict";var $_active_query=!1,$__timer=!1;function be_cli(e){if(void 0===e)return!1;var a=void 0!==e.action&&e.action,t=void 0===e.data?{}:e.data,o=void 0===e.dataType?"json":e.dataType,i=void 0!==e.callBack&&e.callBack,d=void 0!==e.callBack_param&&e.callBack_param,r=void 0!==e.domTarget&&e.domTarget,s=void 0===e.background||e.background,n=!0===e.hasFile,l=void 0===e.url?window.location.href:e.url,c=void 0===e.goodHeader?202:e.goodHeader,m=void 0===e.timeout?1e3*$_out_time:e.timeout;if(!s&&$_active_query)return!1;s||($_active_query=!0),a&&"json"==o&&(t.action=a),!a||"html"!=o||n||"string"!=typeof t||t.includes("action="+a)||(t=t+"&action="+a);var _={url:l,type:"POST",data:t,timeout:m,beforeSend:function(){$__timer&&r&&(clearTimeout($__timer),$__timer=!1),r&&(".watermark"===r&&($("body").find(".watermark").remove(),$("body").append("<div class='watermark loading'><div class='text'>"+$_texts.loading+"</div></div>")),$("body").find(r).removeClass("ok"),$("body").find(r).removeClass("notok"),$("body").find(r).removeClass("failed"),$("body").find(r).addClass("loading"),$("body").find(r).html("<div class='text'>"+$_texts.wait+"</div>"))},complete:function(e,a){r&&$("body").find(r).removeClass("loading"),s||($_active_query=!1);var t="success"==a&&e.status==c,o=e.responseText?e.responseText:"Failed";t?$("body").find(r).addClass("ok"):"Invalid_request_3"!=o||$_user_id?($("body").find(r).addClass("notok"),$("body").addClass("failed"),setTimeout(function(){$("body").removeClass("failed")},1e3)):($("body").find(r).remove(),createNoAccessModal()),r&&$("body").find(r).html(".watermark"===r?"<div class='text'>"+o+"</div>":o),".watermark"===r&&($__timer&&(clearTimeout($__timer),$__timer=!1),$__timer=setTimeout(function(){$("body").find(r).remove()},1e4)),i&&("refresh"===i?t&&pager.page_reload(!1):"string"==typeof i?window[i](t,o,d):i(t,o,d))},error:function(a,t,o){console.log(o,m,e),r&&($("body").find(r).removeClass("loading"),$("body").find(r).addClass("failed")),s||($_active_query=!1);var n=a.responseText?a.responseText:"Failed";r&&$("body").find(r).html(n),".watermark"===r&&($("body").find(".watermark").addClass("failed"),$__timer&&(clearTimeout($__timer),$__timer=!1),$__timer=setTimeout(function(){$("body").find(r).remove()},1e4)),$("body").find(r).addClass("notok"),$("body").addClass("failed"),setTimeout(function(){$("body").removeClass("failed")},1e3),i&&("refresh"===i||("string"==typeof i?window[i](!1,"fatal_error",d):i(!1,n,d)))}};n?(_.contentType=!1,_.processData=!1):"json"==o||(_.dataType="html");$.ajax(_)}function be_cli_forms_hook(){$("form.be_cli_form").length&&($("form.be_cli_form").each(function(e,a){$(a).hasClass("hooked")?$(a).off("submit"):$(a).addClass("hooked")}),$("form.be_cli_form").on("submit",function(e){e.preventDefault();var a=!!$(this).attr("data-hasFile"),t=$(this).attr("data-action"),o=$(this).attr("data-target"),i=$(this).attr("data-callback"),d=$(this).attr("data-callback-param"),r=null;a?(r=new FormData(this)).append("action",t):r=$(this).serialize()+"&action="+t,be_cli({data:r,dataType:"html",callBack:i,callBack_param:d,domTarget:o,hasFile:a})}))}be_cli_forms_hook(),$(document).on("click",".watermark",function(){$(document).find(".watermark").remove()});
